---
layout: post
title: "Causal-Sklearn - åŸºäºCausalEngineâ„¢æ ¸å¿ƒçš„å› æœå›å½’å’Œåˆ†ç±»"
date: 2025-07-06 10:00:00 +0800
description: "åŸºäºçªç ´æ€§CausalEngineâ„¢ç®—æ³•çš„scikit-learnå…¼å®¹å®ç° - å°†å› æœæ¨ç†å¸¦å…¥ä¼ ç»Ÿæœºå™¨å­¦ä¹ ç”Ÿæ€ç³»ç»Ÿã€‚"
tags: [Causal-Sklearn, Scikit-learn, Causality, Machine Learning, Causal Inference]
categories: [Artificial Intelligence]
toc:
  beginning: true
related_posts: true
future: false
featured: true
---

# Causal-Sklearnï¼šå½“æœºå™¨å¼€å§‹ç†è§£"è¿™æ˜¯è°"

> _åŸºäºçªç ´æ€§CausalEngineâ„¢ç®—æ³•çš„scikit-learnå…¼å®¹åŒ…â€”â€”å°†å› æœæ¨ç†çš„å¼ºå¤§èƒ½åŠ›å¸¦å…¥ä¼ ç»Ÿæœºå™¨å­¦ä¹ ç”Ÿæ€ç³»ç»Ÿã€‚å½“AIå­¦ä¼šé—®"è¿™æ˜¯è°"è€Œä¸åªæ˜¯"è¾“å‡ºæ˜¯ä»€ä¹ˆ"æ—¶ï¼Œæˆ‘ä»¬å°±å¼€å¯äº†å› æœæ™ºèƒ½çš„æ–°çºªå…ƒã€‚_

## æ ¸å¿ƒç†å¿µï¼šä»ç¾¤ä½“ç»Ÿè®¡åˆ°ä¸ªä½“æ•…äº‹

æƒ³è±¡ä½ é¢å‰æœ‰ä¸¤ä¸ªå­¦ç”Ÿï¼Œä»–ä»¬æœ‰ç€å®Œå…¨ç›¸åŒçš„èƒŒæ™¯èµ„æ–™â€”â€”åŒæ ·çš„å¹´é¾„ã€åŒæ ·çš„æµ‹è¯•åˆ†æ•°ã€åŒæ ·çš„å­¦ä¹ æ—¶é—´ã€åŒæ ·çš„å®¶åº­ç¯å¢ƒã€‚ä½†å½“è€ƒè¯•ç»“æœå‡ºæ¥æ—¶ï¼Œä¸€ä¸ªå¾—äº†95åˆ†ï¼Œå¦ä¸€ä¸ªåªæœ‰65åˆ†ã€‚

**ä¼ ç»Ÿæœºå™¨å­¦ä¹ **å°†å…¶å½’ä¸ºç»Ÿè®¡å™ªå£°ï¼Œå®ƒå­¦ä¹ çš„æ˜¯ç¾¤ä½“å±‚é¢çš„æ¡ä»¶æœŸæœ› $E[Y|X]$ï¼Œå…¶èŒƒå¼æ˜¯ä»å¯è§‚æµ‹ç‰¹å¾åˆ°ç»“æœçš„æ˜ å°„ï¼š$X \rightarrow Y$ã€‚å¯¹äºè¿™ä¸ªæ¡ˆä¾‹ï¼Œå®ƒçš„ç»“è®ºæ˜¯ï¼š"ç›¸åŒçš„è¾“å…¥ï¼Œä¸åŒçš„è¾“å‡ºï¼Œè¿™å±äºæ— æ³•è§£é‡Šçš„è¯¯å·®é¡¹ã€‚"

**å› æœæœºå™¨å­¦ä¹ **åˆ™è®¤ä¸ºè¿™æ˜¯ä¸¤ä¸ªæœ¬è´¨ä¸åŒçš„ä¸ªä½“ã€‚å®ƒå­¦ä¹ çš„æ˜¯ä¸ªä½“å±‚é¢çš„ç»“æ„æ–¹ç¨‹ $Y = f(U, \varepsilon)$ï¼Œå…¶èŒƒå¼æ˜¯ä»ä¸å¯è§‚æµ‹çš„å› æœè¡¨å¾åˆ°ç»“æœçš„æ¨ç†ï¼š$U \rightarrow Y$ã€‚å®ƒçš„ç»“è®ºæ˜¯ï¼š"è¿™æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„ä¸ªä½“ï¼Œæˆ‘çš„ä»»åŠ¡æ˜¯ç†è§£ä»–ä»¬å†…åœ¨çš„ã€é©±åŠ¨æˆç»©å·®å¼‚çš„æœ¬è´¨åŸå› ã€‚"

è¿™ä¸åªæ˜¯æ•°å­¦ç¬¦å·çš„å˜åŒ–ï¼Œè¿™æ˜¯æ€ç»´æ–¹å¼çš„æ ¹æœ¬è½¬å˜ï¼š**ä»å…³æ³¨ç¾¤ä½“ç»Ÿè®¡ï¼Œåˆ°ç†è§£ä¸ªä½“æ•…äº‹ã€‚** è¿™å°±æ˜¯ **causal-sklearn** çš„ä½¿å‘½ã€‚

## å››å¤§æ ¸å¿ƒçªç ´ï¼šä¸ºä»€ä¹ˆé€‰æ‹©causal-sklearn

causal-sklearnä¸åªæ˜¯å¦ä¸€ä¸ªæœºå™¨å­¦ä¹ åŒ…ï¼Œå®ƒä»£è¡¨ç€å››ä¸ªæ ¹æœ¬æ€§çš„çªç ´ï¼š

**ğŸ¯ çªç ´ä¸€ï¼šå› æœ vs ç›¸å…³**
è¶…è¶Šä¼ ç»Ÿæ¨¡å¼åŒ¹é…ï¼Œå®ç°çœŸæ­£çš„å› æœå…³ç³»ç†è§£ã€‚ä¼ ç»Ÿæ–¹æ³•é—®ï¼š"ä»€ä¹ˆå’Œä»€ä¹ˆç›¸å…³ï¼Ÿ" causal-sklearné—®ï¼š"ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ"

**ğŸ›¡ï¸ çªç ´äºŒï¼šå“è¶Šçš„é²æ£’æ€§**
åœ¨å™ªå£°å’Œå¼‚å¸¸å€¼å­˜åœ¨æ—¶è¡¨ç°å‡ºè‰²ï¼Œè¿œè¶…ä¼ ç»Ÿæ–¹æ³•ã€‚åœ¨30%æ ‡ç­¾å™ªå£°ç¯å¢ƒä¸‹ï¼Œ`CausalEngine`çš„è¯¯å·®ï¼ˆMAE 11.41ï¼‰è¿œä½äºæ ‡å‡†`sklearn MLP`ï¼ˆMAE 47.60ï¼‰ã€‚

| æ–¹æ³•                        | MAE â†“     | RMSE â†“    | RÂ² â†‘       |
| --------------------------- | --------- | --------- | ---------- |
| sklearn MLP                 | 47.60     | 59.87     | 0.8972     |
| **CausalEngine (standard)** | **11.41** | **13.65** | **0.9947** |

**ğŸ§® çªç ´ä¸‰ï¼šå…¨æ–°çš„æ•°å­¦æ¡†æ¶**
ä»¥æŸ¯è¥¿åˆ†å¸ƒä¸ºæ ¸å¿ƒï¼ŒåŸºäºæ·±åˆ»çš„å“²å­¦æ´å¯Ÿï¼ˆ"åœ¨åäº‹å®ä¸–ç•Œé‡Œï¼Œä¸€åˆ‡çš†æœ‰å¯èƒ½"ï¼‰ï¼Œå¸¦æ¥äº†è®¡ç®—ä¸Šçš„æ„å¤–ç¤¼ç‰©â€”â€”å®Œå…¨è§£æåŒ–çš„æ¨ç†è¿‡ç¨‹ã€‚

**ğŸ”§ çªç ´å››ï¼šæ— ç¼çš„sklearnå…¼å®¹**
å®Œç¾èå…¥ç°æœ‰MLå·¥ä½œæµï¼Œæ— éœ€æ”¹å˜ä½¿ç”¨ä¹ æƒ¯ã€‚åªéœ€æ”¹å˜ä¸€è¡Œå¯¼å…¥ï¼Œå³å¯æ‹¥æŠ±å› æœæ™ºèƒ½ã€‚

```python
# ä»ä¼ ç»Ÿæ–¹æ³•
from sklearn.neural_network import MLPRegressor

# åˆ°å› æœæ–¹æ³•ï¼Œåªéœ€æ”¹å˜å¯¼å…¥
from causal_sklearn import MLPCausalRegressor
```

## ä¸ªä½“é€‰æ‹©å˜é‡Uï¼šç†è§£ä¸ªä½“çš„é©å‘½æ€§æ¦‚å¿µ

ä¸ºäº†è®©æœºå™¨ç†è§£ä¸ªä½“ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§å…¨æ–°çš„æ•°å­¦è¯­è¨€ã€‚æˆ‘ä»¬å¼•å…¥äº†**ä¸ªä½“é€‰æ‹©å˜é‡U**â€”â€”ä¸€ä¸ªçœ‹ä¼¼ç®€å•å´é©å‘½æ€§çš„æ¦‚å¿µã€‚

**æ·±åˆ»çš„åŒé‡èº«ä»½**
$U$ æœ‰ç€æ·±åˆ»çš„åŒé‡èº«ä»½ï¼š

- **èº«ä»½ä¸€ï¼šä¸ªä½“é€‰æ‹©å˜é‡** $U=u$ æ„å‘³ç€ä»æ‰€æœ‰å¯èƒ½çš„ä¸ªä½“ä¸­"é€‰æ‹©"äº†ç‰¹å®šä¸ªä½“ $u$ã€‚è¿™å›ç­”äº†"æˆ‘ä»¬é¢å¯¹çš„æ˜¯å“ªä¸€ä¸ªä¸ªä½“ï¼Ÿ"
- **èº«ä»½äºŒï¼šä¸ªä½“å› æœè¡¨å¾** å‘é‡ $u \in \mathbb{R}^d$ åŒ…å«äº†è¿™ä¸ªä¸ªä½“æ‰€æœ‰å†…åœ¨çš„ã€é©±åŠ¨å…¶è¡Œä¸ºçš„æœ¬è´¨å±æ€§ã€‚è¿™å›ç­”äº†"è¿™ä¸ªä¸ªä½“çš„æœ¬è´¨ç‰¹å¾æ˜¯ä»€ä¹ˆï¼Ÿ"

**ä¼˜é›…çš„æ•°å­¦æ¡†æ¶**
é€šè¿‡å¼•å…¥ $U$ï¼Œæˆ‘ä»¬å®ç°äº†ä¸ªä½“å·®å¼‚å»ºæ¨¡ä¸å› æœæ¨ç†çš„ä¼˜é›…ç»Ÿä¸€ï¼š

$$
\begin{aligned}
\text{æ„ŸçŸ¥é˜¶æ®µï¼š} & \quad Z = \text{Perception}(X) \\
\text{å½’å› é˜¶æ®µï¼š} & \quad U \sim \text{Cauchy}(\mu_U(Z), \gamma_U(Z)) \\
\text{è¡ŒåŠ¨é˜¶æ®µï¼š} & \quad S = \text{Action}(U) \\
\text{å†³ç­–é˜¶æ®µï¼š} & \quad Y = \text{Decision}(S)
\end{aligned}
$$

è¿™ä¸ªæ¡†æ¶çš„ç¾å¦™ä¹‹å¤„åœ¨äºï¼š

- **$f(\cdot)$ çš„æ™®é€‚æ€§**ï¼šå¯¹æ‰€æœ‰ä¸ªä½“éƒ½æ˜¯åŒä¸€ä¸ªå› æœå¾‹
- **$U$ çš„ä¸ªä½“æ€§**ï¼šæ¯ä¸ªä¸ªä½“éƒ½æœ‰ç‹¬ç‰¹çš„è¡¨å¾
- **æ¨ç†çš„é€æ˜æ€§**ï¼šæ¯ä¸€æ­¥éƒ½æœ‰æ˜ç¡®çš„è®¤çŸ¥å«ä¹‰

**ä»ç»Ÿè®¡å˜å¼‚åˆ°å› æœè¡¨å¾çš„ç†è®ºè·ƒè¿**
è®©æˆ‘ä»¬ç”¨ä¸€ä¸ªå¯¹æ¯”æ¥ç†è§£è¿™ä¸ªçªç ´çš„é‡è¦æ€§ï¼š
| æ–¹æ³•ç±»å‹ | ä¸ªä½“å·®å¼‚å¤„ç† | æ•°å­¦è¡¨ç¤º | å“²å­¦åœ°ä½ |
| ---------------- | ------------ | ------------------------------ | -------------------- |
| **ä¼ ç»Ÿå›å½’** | è¯¯å·®é¡¹ | $Y = f(X) + \varepsilon$ | ç»Ÿè®¡å™ªå£°ï¼Œéœ€è¦æŠ‘åˆ¶ |
| **æ··åˆæ•ˆåº”æ¨¡å‹** | éšæœºæ•ˆåº” | $Y = f(X) + b_i + \varepsilon$ | ç»Ÿè®¡å˜å¼‚ï¼Œæ— ç»“æ„ |
| **å› æœå›å½’** | **å› æœè¡¨å¾** | $Y = f(U, \varepsilon)$ | **å› æœå®ä½“ï¼Œå¯è§£é‡Š** |

è¿™ç§è½¬å˜è®©æˆ‘ä»¬èƒ½å¤Ÿå°†ä¸ªä½“å·®å¼‚ä»"éœ€è¦æ§åˆ¶çš„å˜å¼‚"è½¬åŒ–ä¸º"éœ€è¦ç†è§£çš„ä¿¡æ¯"ï¼Œå¹¶ä¸ºä¸ªä½“åŒ–åäº‹å®æ¨ç†æä¾›äº†æ•°å­¦åŸºç¡€ã€‚

## è®¤çŸ¥å¯å‘æ¶æ„ï¼šå››ä¸ªé—®é¢˜æ„æˆçš„æ™ºèƒ½å¾ªç¯

äººç±»æ˜¯å¦‚ä½•ç†è§£ä¸–ç•Œçš„ï¼Ÿæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªå››é˜¶æ®µçš„æ¨ç†è¿‡ç¨‹ï¼Œæ¨¡æ‹Ÿäººç±»ä»è§‚å¯Ÿåˆ°ç†è§£çš„å®Œæ•´è®¤çŸ¥è¿‡ç¨‹ï¼Œå®ƒä¸ä¼ ç»Ÿçš„ $Y = \text{BlackBox}(X)$ é»‘ç®±æ˜ å°„æœ‰ç€æœ¬è´¨åŒºåˆ«ã€‚æˆ‘ä»¬çš„å› æœæ¶æ„æ˜¯å“²å­¦é©±åŠ¨çš„é€æ˜æ¨ç†ï¼š$X \rightarrow Z \rightarrow U \rightarrow S \rightarrow Y$ã€‚

**ç¬¬ä¸€é—®ï¼š"æˆ‘çœ‹åˆ°äº†ä»€ä¹ˆï¼Ÿ" (Perception)**
$$Z = \text{PerceptionNetwork}(X)$$
ä»å¤æ‚çš„åŸå§‹ä¿¡æ¯ä¸­æå–æœ‰æ„ä¹‰çš„ç‰¹å¾ï¼Œå°±åƒäººç±»è§‚å¯Ÿä¸–ç•Œæ—¶è‡ªç„¶è¿›è¡Œçš„æ„ŸçŸ¥è¿‡ç¨‹ã€‚è¿™ä¸€é˜¶æ®µå°†æ··ä¹±çš„å¤–éƒ¨è¯æ®è½¬åŒ–ä¸ºç»“æ„åŒ–çš„è®¤çŸ¥ç‰¹å¾ã€‚

**ç¬¬äºŒé—®ï¼š"è¿™èƒŒåæ˜¯ä»€ä¹ˆæ ·çš„ä¸ªä½“ï¼Ÿ" (Abduction)**

$$
\begin{aligned}
\mu_U(Z) &= \text{LocNetwork}(Z) \\
\gamma_U(Z) &= \text{ScaleNetwork}(Z) \\
U &\sim \text{Cauchy}(\mu_U(Z), \gamma_U(Z))
\end{aligned}
$$

è¿™æ˜¯æ•´ä¸ªç³»ç»Ÿçš„æ ¸å¿ƒåˆ›æ–°ã€‚ä¸æ˜¯é—®"è¿™ä¸ªè¾“å…¥ä¼šäº§ç”Ÿä»€ä¹ˆè¾“å‡º"ï¼Œè€Œæ˜¯é—®"ä»€ä¹ˆæ ·çš„ä¸ªä½“ä¼šäº§ç”Ÿè¿™æ ·çš„è¯æ®ï¼Ÿ"è¿™æ˜¯ä¸€ç§é€†å‘æ¨ç†â€”â€”ä»ç»“æœæ¨åŸå› ï¼Œæ­£æ˜¯äººç±»æ™ºèƒ½çš„æ ¸å¿ƒç‰¹å¾ã€‚

**ç¬¬ä¸‰é—®ï¼š"è¿™æ ·çš„ä¸ªä½“ä¼šå¦‚ä½•è¡ŒåŠ¨ï¼Ÿ" (Action)**
$$S = \text{ActionNetwork}(U)$$
åŸºäºå¯¹ä¸ªä½“æœ¬è´¨çš„ç†è§£ï¼Œåº”ç”¨æ™®é€‚çš„å› æœè§„å¾‹ï¼Œé¢„æµ‹å…¶å¯èƒ½çš„è¡Œä¸ºã€‚è¿™é‡Œä½“ç°äº†å› æœå¾‹çš„ç¡®å®šæ€§å’Œæ™®é€‚æ€§ï¼šç›¸åŒçš„ä¸ªä½“è¡¨å¾æ€»æ˜¯äº§ç”Ÿç›¸åŒçš„å†³ç­–å€¾å‘ã€‚

**ç¬¬å››é—®ï¼š"å…·ä½“çš„å†³ç­–æ˜¯ä»€ä¹ˆï¼Ÿ" (Decision)**
$$Y = \text{DecisionHead}(S)$$
å°†æŠ½è±¡çš„å†³ç­–å€¾å‘è½¬åŒ–ä¸ºå…·ä½“ä»»åŠ¡éœ€è¦çš„è¾“å‡ºæ ¼å¼ï¼Œå»ºç«‹å› æœæ¨ç†ä¸å®é™…åº”ç”¨ä¹‹é—´çš„æ¡¥æ¢ã€‚

## å“²å­¦é€‰æ‹©ï¼šæŸ¯è¥¿åˆ†å¸ƒä¸è®¡ç®—ä¼˜åŠ¿

åœ¨è®¾è®¡è¿™ä¸ªç³»ç»Ÿæ—¶ï¼Œæˆ‘ä»¬é¢ä¸´ä¸€ä¸ªæ ¹æœ¬æ€§çš„å“²å­¦é€‰æ‹©ï¼šå½“æˆ‘ä»¬ä¸èƒ½å®Œå…¨ç¡®å®šä¸€ä¸ªä¸ªä½“çš„æœ¬è´¨æ—¶ï¼Œåº”è¯¥å¦‚ä½•è¡¨è¾¾è¿™ç§ä¸ç¡®å®šæ€§ï¼Ÿæˆ‘ä»¬çš„ç­”æ¡ˆæºäºä¸€ä¸ªæ·±åˆ»çš„è®¤çŸ¥åŸåˆ™ï¼š

> **"åœ¨åäº‹å®çš„ä¸–ç•Œé‡Œï¼Œä»»ä½•ç»“æœéƒ½æœ‰å¯èƒ½ç”±ä»»ä½•ä¸ªä½“åˆ›é€ ã€‚"**

è¿™å¥è¯æé†’æˆ‘ä»¬ä¿æŒå¼€æ”¾ï¼šæˆ‘ä»¬æ°¸è¿œæ— æ³•å®Œå…¨æ´æ‚‰ä¸€ä¸ªä¸ªä½“çš„å…¨éƒ¨æ½œèƒ½ã€‚è¿™ç§å“²å­¦ç«‹åœºï¼Œè‡ªç„¶åœ°å°†æˆ‘ä»¬å¼•å‘äº†**æŸ¯è¥¿åˆ†å¸ƒ**â€”â€”é‚£ä¸ªåœ¨ä¼ ç»Ÿç»Ÿè®¡å­¦ä¸­è¢«è®¤ä¸º"ç—…æ€"çš„åˆ†å¸ƒï¼Œå› ä¸ºå®ƒé‡å°¾çš„ç‰¹æ€§ä¸º"ä¸€åˆ‡çš†æœ‰å¯èƒ½"çš„åäº‹å®æ¨æ–­ä¿ç•™äº†æ¦‚ç‡ï¼Œä¸”å…¶æœŸæœ›å’Œæ–¹å·®æœªå®šä¹‰ï¼Œè¯šå®åœ°è¡¨è¾¾äº†"æˆ‘ä»¬æ°¸è¿œæ— æ³•å®Œå…¨äº†è§£ä¸€ä¸ªä¸ªä½“"çš„å“²å­¦äº‹å®ã€‚

$$f(x|\mu, \gamma) = \frac{1}{\pi\gamma}\left[1 + \left(\frac{x-\mu}{\gamma}\right)^2\right]^{-1}$$

è¿™ç§"å“²å­¦å¿…ç„¶æ€§"å´å¸¦æ¥äº†è®¡ç®—ä¸Šçš„å¤©èµè‰¯æœºã€‚æŸ¯è¥¿åˆ†å¸ƒå…·æœ‰çº¿æ€§ç¨³å®šæ€§ï¼š
$$X \sim \text{Cauchy}(\mu, \gamma) \Rightarrow aX + b \sim \text{Cauchy}(a\mu + b, |a|\gamma)$$
è¿™è®©æˆ‘ä»¬çš„æ•´ä¸ªå››é˜¶æ®µæ¨ç†è¿‡ç¨‹å¯ä»¥å®Œå…¨è§£æåŒ–ï¼Œæ— éœ€ä»»ä½•é‡‡æ ·ï¼æˆ‘ä»¬å› ä¸ºå“²å­¦ä¸Šçš„è‡ªæ´½è€Œé€‰æ‹©äº†æŸ¯è¥¿åˆ†å¸ƒï¼Œå´æ„å¤–åœ°è·å¾—äº†è®¡ç®—ä¸Šçš„å·¨å¤§ä¼˜åŠ¿ã€‚è¿™æ­£æ˜¯æ·±åˆ»ç†è®ºçš„æ ‡å¿—ã€‚

## CausalEngineçš„æŠ€æœ¯å®ç°

**ç»Ÿä¸€æ¨ç†æ¡†æ¶**
CausalEngineé€šè¿‡æ¸©åº¦å‚æ•° $\tau$ å’Œé‡‡æ ·æ ‡å¿—å®ç°äº†å¤šç§æ¨ç†æ¨¡å¼çš„ç»Ÿä¸€ï¼š

```python
def inference(self, X, temperature=1.0, do_sample=False):
    # æ„ŸçŸ¥é˜¶æ®µ
    Z = self.perception_network(X)

    # å½’å› é˜¶æ®µ
    mu_U, gamma_U = self.abduction_network(Z)

    if temperature == 0:
        # çº¯å› æœæ¨¡å¼
        U_effective = mu_U
    elif do_sample:
        # é‡‡æ ·æ¨¡å¼
        noise = torch.distributions.Cauchy(0, 1).sample(mu_U.shape)
        U_effective = mu_U + temperature * self.b_noise * noise
    else:
        # æ ‡å‡†æ¨¡å¼
        gamma_U_effective = gamma_U + temperature * torch.abs(self.b_noise)
        U_effective = torch.distributions.Cauchy(mu_U, gamma_U_effective).sample()

    # è¡ŒåŠ¨é˜¶æ®µ
    S = self.action_network(U_effective)

    # å†³ç­–é˜¶æ®µ
    return self.decision_head(S)
```

**ä¸ç¡®å®šæ€§çš„å› æœåˆ†è§£**
CausalEngineèƒ½å¤Ÿå°†æ€»ä½“ä¸ç¡®å®šæ€§åˆ†è§£ä¸ºä¸¤ä¸ªæœ‰æ˜ç¡®å«ä¹‰çš„éƒ¨åˆ†ï¼š
$$\text{æ€»ä¸ç¡®å®šæ€§} = \text{è®¤çŸ¥ä¸ç¡®å®šæ€§} + \text{å¤–ç”Ÿä¸ç¡®å®šæ€§}$$
å…¶ä¸­ï¼š

- **è®¤çŸ¥ä¸ç¡®å®šæ€§** $\gamma_U(X)$ï¼šæˆ‘ä»¬å¯¹ä¸ªä½“ $U$ ç†è§£çš„å±€é™æ€§
- **å¤–ç”Ÿä¸ç¡®å®šæ€§** $|\beta_{\text{noise}}|$ï¼šä¸–ç•Œæœ¬èº«çš„å›ºæœ‰éšæœºæ€§

```python
def uncertainty_decomposition(self, X):
    mu_U, gamma_U = self.abduction_network(self.perception_network(X))

    return {
        'epistemic': gamma_U,           # "æˆ‘ä»¬ä¸çŸ¥é“"
        'aleatoric': torch.abs(self.b_noise),  # "ä¸–ç•Œæœ¬èº«éšæœº"
        'total': gamma_U + torch.abs(self.b_noise)
    }
```

è¿™ç§åˆ†è§£ä¸ºå¯ä¿¡AIçš„å‘å±•æä¾›äº†é‡è¦åŸºç¡€ã€‚

## ä»ç†è®ºåˆ°å®è·µï¼šcausal-sklearnçš„è¯ç”Ÿ

æˆ‘ä»¬å¸Œæœ›è®©å› æœæ™ºèƒ½çš„é©å‘½æ€§æ€æƒ³è§¦æ‰‹å¯åŠã€‚causal-sklearnçš„è®¾è®¡ç›®æ ‡æ˜¯è®©ç”¨æˆ·ä»¥æœ€å°çš„å­¦ä¹ æˆæœ¬äº«å—å› æœæ¨ç†çš„å¼ºå¤§èƒ½åŠ›ã€‚

**æ— ç—›å‡çº§çš„è®¾è®¡å“²å­¦**
ä»ä¼ ç»Ÿæ–¹æ³•åˆ°å› æœæ–¹æ³•ï¼Œåªéœ€æ”¹å˜å¯¼å…¥ï¼Œæ— ç¼é›†æˆã€‚

```python
# ä¼ ç»Ÿæ–¹æ³•
from sklearn.neural_network import MLPRegressor
model = MLPRegressor(...)
# å› æœæ–¹æ³•ï¼šåªéœ€æ”¹å˜å¯¼å…¥
from causal_sklearn import MLPCausalRegressor
model = MLPCausalRegressor(...)
```

**çµæ´»çš„æ¨ç†æ¨¡å¼**
CausalEngineæä¾›äº†å››ç§æ¨ç†æ¨¡å¼ï¼Œæ¯ç§éƒ½å¯¹åº”ä¸åŒçš„åº”ç”¨åœºæ™¯å’Œå“²å­¦å‡è®¾ï¼š

```python
model_deterministic = MLPCausalRegressor(mode='deterministic') # ä¸ä¼ ç»Ÿæ–¹æ³•ç­‰ä»·
model_exogenous = MLPCausalRegressor(mode='exogenous') # å¼ºè°ƒç¯å¢ƒéšæœºæ€§
model_endogenous = MLPCausalRegressor(mode='endogenous') # å¼ºè°ƒè®¤çŸ¥ä¸ç¡®å®šæ€§
model_standard = MLPCausalRegressor(mode='standard') # å¹³è¡¡ä¸¤ç§ä¸ç¡®å®šæ€§ï¼Œé€šå¸¸æ€§èƒ½æœ€ä½³
```

**è¶…è¶Šç‚¹ä¼°è®¡çš„ä¸°å¯Œä¿¡æ¯**
ä¸ä¼ ç»Ÿæ–¹æ³•åªèƒ½ç»™å‡ºç‚¹ä¼°è®¡ä¸åŒï¼Œcausal-sklearnèƒ½å¤Ÿæä¾›å®Œæ•´çš„æ¨ç†æ•…äº‹ï¼ŒåŒ…æ‹¬é¢„æµ‹åˆ†å¸ƒå’Œä¸ç¡®å®šæ€§åˆ†è§£ã€‚

```python
# è·å¾—å®Œæ•´çš„å› æœå™è¿°
point_predictions = model.predict(X_test)
distributions = model.predict_dist(X_test)
uncertainty = model.uncertainty_decomposition(X_test)
```

## ç«‹å³å¼€å§‹ï¼š5åˆ†é’Ÿä½“éªŒå› æœæ™ºèƒ½

**å®‰è£…ä¸éªŒè¯**

```bash
# é€šè¿‡PyPIå®‰è£…ï¼ˆæ¨èï¼‰
pip install causal-sklearn
# éªŒè¯å®‰è£…
python -c "import causal_sklearn; print('å› æœæ™ºèƒ½å·²å°±ç»ªï¼ğŸ‰')"
```

**ä½ çš„ç¬¬ä¸€ä¸ªå› æœæ¨¡å‹**

```python
from causal_sklearn import MLPCausalRegressor
from sklearn.datasets import make_regression
from sklearn.model_selection import train_test_split

X, y = make_regression(n_samples=1000, n_features=20, noise=0.1)
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)
regressor = MLPCausalRegressor(mode='standard', random_state=42)
regressor.fit(X_train, y_train)

# ä¸åªæ˜¯é¢„æµ‹ï¼Œè¿˜æœ‰ç†è§£
predictions = regressor.predict(X_test)                # ç‚¹é¢„æµ‹
distributions = regressor.predict_dist(X_test)         # åˆ†å¸ƒå‚æ•°
uncertainty = regressor.uncertainty_decomposition(X_test)  # ä¸ç¡®å®šæ€§åˆ†æ

print(f"é¢„æµ‹å€¼: {predictions[0]:.3f}")
print(f"ä¸ªä½“è¡¨å¾ä½ç½®: {distributions['loc'][0]:.3f}")
print(f"è®¤çŸ¥ä¸ç¡®å®šæ€§: {uncertainty['epistemic'][0]:.3f}")
print(f"å¤–ç”Ÿä¸ç¡®å®šæ€§: {uncertainty['aleatoric'][0]:.3f}")
```

**æ€§èƒ½éªŒè¯**
æˆ‘ä»¬æä¾›äº†å¿«é€ŸéªŒè¯è„šæœ¬ï¼Œè®©æ‚¨äº²çœ¼è§è¯å› æœæ™ºèƒ½åœ¨å™ªå£°ç¯å¢ƒä¸‹çš„å“è¶Šæ€§èƒ½ã€‚

```bash
# è¿è¡Œå®Œæ•´çš„å¿«é€Ÿæµ‹è¯•ï¼ˆå›å½’+åˆ†ç±»ï¼‰
python scripts/quick_test_causal_engine.py
```

**ä»¤äººéœ‡æ’¼çš„å®éªŒç»“æœ**ï¼ˆ30%æ ‡ç­¾å™ªå£°ï¼‰ï¼š

- **å›å½’ä»»åŠ¡**: `Causal (standard)` çš„MAE(11.41)è¿œä½äº`sklearn MLP`(47.60)ã€‚
- **åˆ†ç±»ä»»åŠ¡**: `Causal (standard)` çš„Accuracy(0.9225)æ˜¾è‘—é«˜äº`sklearn MLP`(0.8850)ã€‚

æ‚¨è¿˜å¯ä»¥é€šè¿‡è¿è¡ŒçœŸå®ä¸–ç•Œæ•°æ®é›†ï¼ˆå¦‚åŠ å·æˆ¿ä»·ï¼‰çš„æ•™ç¨‹ï¼Œæ¥æ›´æ·±å…¥åœ°äº†è§£å…¶æ€§èƒ½ã€‚

```bash
python examples/comprehensive_causal_modes_tutorial_sklearn_style.py
```

## è¶…è¶Šé¢„æµ‹ï¼šé€šå¾€"ä¸åŒ"AIçš„å¯èƒ½æ€§

**æ›´è¯šå®ã€å…¬å¹³ã€æœ‰æ´å¯ŸåŠ›çš„AI**
CausalEngineçš„èƒ½åŠ›è¿œä¸æ­¢äºç²¾å‡†é¢„æµ‹ã€‚

- **æ›´è¯šå®**: å®ƒèƒ½ç²¾ç¡®é‡åŒ–ä¸ç¡®å®šæ€§çš„æ¥æºï¼ˆè®¤çŸ¥å±€é™ vs. ä¸–ç•Œéšæœºæ€§ï¼‰ï¼Œè®©AIæˆä¸ºå¯ä¿¡èµ–çš„å†³ç­–ä¼™ä¼´ã€‚
- **æ›´å…¬å¹³**: å®ƒé€šè¿‡åˆ†ç¦»ä¸ªä½“çš„"æœ¬è´¨"($U$)ä¸"è¡¨é¢å±æ€§"ï¼Œä¸ºæ„å»ºåŸºäºèƒ½åŠ›è€Œéç»Ÿè®¡åè§çš„å†³ç­–ç³»ç»Ÿæä¾›äº†æŠ€æœ¯åŸºç¡€ã€‚
- **æ›´å…·æ´å¯ŸåŠ›**: å®ƒè®©æ¯ä¸ªé¢„æµ‹éƒ½å˜æˆä¸€ä¸ªå®Œæ•´çš„ã€å¯è§£é‡Šçš„å› æœæ•…äº‹ï¼Œä»æ„ŸçŸ¥ã€å½’å› åˆ°è¡ŒåŠ¨å’Œå†³ç­–ã€‚

## ç»“è¯­ï¼šå¼€å¯ä½ çš„å› æœæ™ºèƒ½ä¹‹æ—…

åœ¨æœºå™¨å­¦ä¹ çš„å†å²é•¿æ²³ä¸­ï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨è¿½æ±‚æ›´å¥½çš„é¢„æµ‹ã€‚ä½†causal-sklearnä»£è¡¨ç€ä¸€ä¸ªæ›´æ·±åˆ»çš„è¿½æ±‚ï¼š**è®©æœºå™¨çœŸæ­£ç†è§£ä¸–ç•Œã€‚**

ä¸å†æ»¡è¶³äº"ä»€ä¹ˆå’Œä»€ä¹ˆç›¸å…³"ï¼Œè€Œæ˜¯è¿½æ±‚"ä¸ºä»€ä¹ˆä¼šè¿™æ ·"ã€‚
ä¸å†åªå…³æ³¨"ç¾¤ä½“çš„å¹³å‡è¡¨ç°"ï¼Œè€Œæ˜¯ç†è§£"æ¯ä¸ªä¸ªä½“çš„ç‹¬ç‰¹æ€§"ã€‚
ä¸å†åªåš"æ¨¡å¼åŒ¹é…"ï¼Œè€Œæ˜¯è¿›è¡Œ"å› æœæ¨ç†"ã€‚

å½“ä½ çœ‹åˆ°CausalEngineå¦‚ä½•ä»æ•°æ®ä¸­è¯†åˆ«å‡ºæ¯ä¸ªä¸ªä½“çš„ç‹¬ç‰¹æœ¬è´¨ï¼Œå½“ä½ ä½“éªŒåˆ°AIä¸å†åªæ˜¯é¢„æµ‹è€Œæ˜¯çœŸæ­£"ç†è§£"æ—¶ï¼Œä½ å°±ä¼šæ˜ç™½ï¼š**æˆ‘ä»¬ä¸åªæ˜¯åœ¨ä½¿ç”¨ä¸€ä¸ªæ›´å¥½çš„ç®—æ³•ï¼Œæˆ‘ä»¬åœ¨å‚ä¸ä¸€åœºæ™ºèƒ½çš„é©å‘½ã€‚**

**Judea Pearlç”¨"å› æœé˜¶æ¢¯"** æè¿°äº†æ™ºèƒ½çš„ä¸‰ä¸ªå±‚æ¬¡ï¼šå…³è”ã€å¹²é¢„å’Œåäº‹å®ã€‚ä¼ ç»Ÿæœºå™¨å­¦ä¹ å¤§å¤šåœç•™åœ¨ç¬¬ä¸€å±‚ã€‚è€ŒCausalEngineä»è¯ç”Ÿä¹‹åˆï¼Œå°±æ˜¯ä¸ºæ”€ç™»æ›´é«˜çš„é˜¶æ¢¯è€Œè®¾è®¡çš„ã€‚å®ƒçš„å½’å› æ¨æ–­æœ¬èº«å°±æ˜¯ä¸€ç§åäº‹å®æ€è€ƒï¼ˆ"ä»€ä¹ˆæ ·çš„ä¸ªä½“ä¼šäº§ç”Ÿè¿™æ ·çš„ç»“æœï¼Ÿ"ï¼‰ï¼Œå…¶æ•°å­¦æ¡†æ¶ä¸ºå¹²é¢„å’Œåäº‹å®åˆ†ææä¾›äº†åšå®çš„åŸºç¡€ã€‚æˆ‘ä»¬ç›¸ä¿¡ï¼Œè¿™ä¸åªæ˜¯ä¸€ä¸ªæ›´å¥½çš„é¢„æµ‹å·¥å…·ï¼Œè€Œæ˜¯é€šå¾€çœŸæ­£å› æœæ™ºèƒ½çš„é‡è¦ä¸€æ­¥ã€‚

**ç«‹å³å¼€å§‹ä½“éªŒå§ï¼**

```bash
# ç¬¬ä¸€æ­¥ï¼šå®‰è£…
pip install causal-sklearn

# ç¬¬äºŒæ­¥ï¼šä½“éªŒ
git clone https://github.com/1587causalai/causal-sklearn.git
python scripts/quick_test_causal_engine.py
```

å¦‚æœæ‚¨åœ¨ç ”ç©¶ä¸­ä½¿ç”¨äº†Causal-Sklearnï¼Œæˆ‘ä»¬ä¸èƒœæ„Ÿæ¿€ï¼Œè¯·å¼•ç”¨ï¼š

```bibtex
@software{causal_sklearn,
  title={Causal-Sklearn: Scikit-learn Compatible Causal Regression and Classification},
  author={Heyang Gong},
  year={2025},
  url={https://github.com/1587causalai/causal-sklearn},
  note={åŸºäºCausalEngineâ„¢æ ¸å¿ƒçš„å› æœå›å½’å’Œå› æœåˆ†ç±»ç®—æ³•çš„scikit-learnå…¼å®¹å®ç°}
}
```
